# CertWarden API Client Configuration with Actions

# Your API key for authentication
api_key: "your_api_key_here"

# API configuration
api:
  base_url: "https://api.certwarden.com"
  headers:
    Content-Type: "application/json"

# Output configuration
output:
  directory: "./certificates"
  filename_template: "{common_name}_{cert_id}"
  extensions:
    certificate: ".crt"
    private_key: ".key"
    chain: "_chain.pem"
    combined: "_combined.pem"

# Default options
defaults:
  format: "pem"
  expiry_alert_days: 30

# Actions global setting
actions:
  enabled: true

# Certificate groups to retrieve
certificates:
  # Group 1: Retrieve specific certificates by ID
  production_web_servers:
    method: "individual"
    format: "pem"
    certificates:
      - "cert_123abc"
      - "cert_456def"
    output:
      directory: "./certificates/production"
    # Action to run after certificate retrieval
    action:
      command: "cp {certificate} {private_key} /etc/nginx/ssl/ && systemctl reload nginx"
      run_on: "new"  # Only run for new certificates
  
  # Group 2: Retrieve certificates by search query
  wildcard_certificates:
    method: "search"
    format: "pem"
    query: "*.example.com"
    output:
      directory: "./certificates/wildcard"
    # Action to run after certificate retrieval
    action:
      command: "cp {combined} /etc/haproxy/ssl/ && systemctl reload haproxy"
      run_on: "all"  # Run for all certificates
  
  # Group 3: Retrieve expiring certificates
  expiring_certificates:
    method: "expiring"
    format: "pem"
    days: 30
    output:
      directory: "./certificates/expiring"
    # Action to run after certificate retrieval
    action:
      command: "echo 'Certificate {common_name} ({cert_id}) expiring soon' | mail -s 'Certificate Expiration Warning' admin@example.com"
      run_on: "all"

